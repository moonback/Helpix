import{c as M,r as n,j as e}from"./index-CpgGJGF8.js";import{S as q}from"./search-lrFEIuW5.js";import{N as A}from"./navigation-CNwS7Wzo.js";import{X as I}from"./x-Bgj35mxq.js";import{M as m}from"./map-pin-DoY9rUxZ.js";import{A as H}from"./index-5ukV9Jv9.js";import{m as P}from"./Button-BBV6hfQw.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C=M("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D=M("Tag",[["path",{d:"M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2Z",key:"14b2ls"}],["path",{d:"M7 7h.01",key:"7u93v4"}]]),J=({value:l,onChange:a,onLocationSelect:i,placeholder:x="Rechercher une adresse...",label:p="Adresse",required:u=!1,className:g=""})=>{const[o,c]=n.useState(l),[w,h]=n.useState([]),[$,k]=n.useState(!1),[R,f]=n.useState(!1),[y,b]=n.useState(null),[S,j]=n.useState(!1),d=n.useRef(),v=n.useRef(null),E=async t=>{if(t.length<3){h([]);return}k(!0);try{const r=await(await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(t)}&limit=5&addressdetails=1&countrycodes=fr,be,ch,ca&accept-language=fr`)).json();h(r)}catch(s){console.error("Erreur lors de la recherche d'adresse:",s)}finally{k(!1)}},T=()=>{navigator.geolocation&&(j(!0),navigator.geolocation.getCurrentPosition(async t=>{const{latitude:s,longitude:r}=t.coords;b({lat:s,lng:r});try{const L=(await(await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${s}&lon=${r}&addressdetails=1&accept-language=fr`)).json()).display_name;c(L),a(L),i&&i(s,r)}catch(F){console.error("Erreur lors de la r√©cup√©ration de l'adresse:",F);const N=`${s.toFixed(6)}, ${r.toFixed(6)}`;c(N),a(N)}j(!1)},t=>{console.error("Erreur de g√©olocalisation:",t),j(!1)}))};n.useEffect(()=>(d.current&&clearTimeout(d.current),o.length>=3?d.current=setTimeout(()=>{E(o)},300):h([]),()=>{d.current&&clearTimeout(d.current)}),[o]);const _=t=>{const s=t.display_name;c(s),a(s),b({lat:parseFloat(t.lat),lng:parseFloat(t.lon)}),f(!1),i&&i(parseFloat(t.lat),parseFloat(t.lon))},z=t=>{const{address:s}=t,r=[];return s.house_number&&s.road?r.push(`${s.house_number} ${s.road}`):s.road&&r.push(s.road),s.postcode&&s.city?r.push(`${s.postcode} ${s.city}`):s.city&&r.push(s.city),s.country&&r.push(s.country),r.length>0?r.join(", "):t.display_name},O=()=>{c(""),a(""),b(null),h([]),f(!1),v.current&&v.current.focus()};return e.jsxs("div",{className:`relative ${g}`,children:[p&&e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[p," ",u&&e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(q,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{ref:v,type:"text",value:o,onChange:t=>{c(t.target.value),f(!0)},onFocus:()=>f(!0),placeholder:x,className:"w-full pl-10 pr-20 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",required:u}),e.jsx("button",{type:"button",onClick:T,disabled:S,className:"absolute inset-y-0 right-0 pr-3 flex items-center text-primary-600 hover:text-primary-700 disabled:opacity-50",title:"Utiliser ma localisation actuelle",children:S?e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-primary-600"}):e.jsx(A,{className:"h-5 w-5"})}),o&&e.jsx("button",{type:"button",onClick:O,className:"absolute inset-y-0 right-12 pr-3 flex items-center text-gray-400 hover:text-gray-600",title:"Effacer",children:e.jsx(I,{className:"h-4 w-4"})})]}),y&&e.jsxs("div",{className:"mt-2 flex items-center gap-2 text-sm text-green-600 bg-green-50 px-3 py-1 rounded-full",children:[e.jsx(m,{className:"w-4 h-4"}),e.jsxs("span",{children:["Localisation s√©lectionn√©e : ",y.lat.toFixed(6),", ",y.lng.toFixed(6)]})]}),e.jsx(H,{children:R&&(w.length>0||$)&&e.jsx(P.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"absolute z-50 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:$?e.jsxs("div",{className:"p-4 text-center text-gray-500",children:[e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-primary-600 mx-auto mb-2"}),"Recherche en cours..."]}):e.jsx("div",{className:"py-2",children:w.map((t,s)=>e.jsx("button",{type:"button",onClick:()=>_(t),className:"w-full px-4 py-3 text-left hover:bg-gray-50 focus:bg-gray-50 focus:outline-none transition-colors",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(m,{className:"w-4 h-4 text-gray-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium text-gray-900 truncate",children:z(t)}),e.jsx("div",{className:"text-sm text-gray-500 truncate",children:t.display_name}),e.jsxs("div",{className:"text-xs text-gray-400 mt-1",children:["Type: ",t.type," ‚Ä¢ Coordonn√©es: ",parseFloat(t.lat).toFixed(4),", ",parseFloat(t.lon).toFixed(4)]})]})]})},s))})})}),e.jsx("div",{className:"mt-2 text-xs text-gray-500",children:"üí° Tapez au moins 3 caract√®res pour voir les suggestions ‚Ä¢ üß≠ Cliquez sur l'ic√¥ne de navigation pour utiliser votre localisation actuelle"})]})},K=({latitude:l,longitude:a,address:i,className:x=""})=>{const p=n.useRef(null),u=()=>{if(l&&a){const o=`https://www.google.com/maps?q=${l},${a}`;window.open(o,"_blank")}},g=()=>{if(l&&a){const o=`https://www.openstreetmap.org/?mlat=${l}&mlon=${a}&zoom=15`;window.open(o,"_blank")}};return!l||!a?e.jsxs("div",{className:`bg-gray-100 rounded-lg p-8 text-center ${x}`,children:[e.jsx(m,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"Aucune localisation s√©lectionn√©e"}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Utilisez la recherche d'adresse pour s√©lectionner un lieu"})]}):e.jsxs("div",{className:`space-y-4 ${x}`,children:[e.jsx("div",{className:"relative bg-gray-100 rounded-lg overflow-hidden",children:e.jsxs("div",{ref:p,className:"w-full h-48 bg-gray-200 relative",children:[e.jsx("iframe",{src:`https://www.openstreetmap.org/export/embed.html?bbox=${a-.01},${l-.01},${a+.01},${l+.01}&layer=mapnik&marker=${l},${a}`,width:"100%",height:"100%",frameBorder:"0",scrolling:"no",marginHeight:0,marginWidth:0,title:"Carte de localisation",className:"w-full h-full"}),e.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2",children:e.jsx("div",{className:"w-6 h-6 bg-red-500 rounded-full border-2 border-white shadow-lg flex items-center justify-center",children:e.jsx(m,{className:"w-4 h-4 text-white"})})})]})}),e.jsx("div",{className:"bg-white rounded-lg p-4 border border-gray-200",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("h3",{className:"font-medium text-gray-900 mb-2 flex items-center gap-2",children:[e.jsx(m,{className:"w-4 h-4 text-primary-600"}),"Localisation s√©lectionn√©e"]}),i&&e.jsx("p",{className:"text-gray-700 mb-2",children:i}),e.jsxs("div",{className:"text-sm text-gray-500 space-y-1",children:[e.jsxs("p",{children:["Latitude: ",l.toFixed(6)]}),e.jsxs("p",{children:["Longitude: ",a.toFixed(6)]})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("button",{type:"button",onClick:u,className:"flex items-center gap-2 px-3 py-2 text-sm bg-blue-50 text-blue-700 rounded-lg hover:bg-blue-100 transition-colors",title:"Ouvrir dans Google Maps",children:[e.jsx(C,{className:"w-4 h-4"}),"Google Maps"]}),e.jsxs("button",{type:"button",onClick:g,className:"flex items-center gap-2 px-3 py-2 text-sm bg-green-50 text-green-700 rounded-lg hover:bg-green-100 transition-colors",title:"Ouvrir dans OpenStreetMap",children:[e.jsx(C,{className:"w-4 h-4"}),"OpenStreetMap"]})]})]})}),e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[e.jsxs("h4",{className:"font-medium text-blue-900 mb-2 flex items-center gap-2",children:[e.jsx(A,{className:"w-4 h-4"}),"Actions rapides"]}),e.jsxs("div",{className:"text-sm text-blue-700 space-y-1",children:[e.jsx("p",{children:"‚Ä¢ üì± Partager cette localisation"}),e.jsx("p",{children:"‚Ä¢ üöó Obtenir l'itin√©raire"}),e.jsx("p",{children:"‚Ä¢ üìç Sauvegarder comme favori"})]})]})]})};export{J as A,K as L,D as T};
