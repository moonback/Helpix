import{u as f,a as j,r as n,j as e}from"./index-CZ_6CMrD.js";import{u as N}from"./taskStore-gSjSJ0xc.js";import{B as p}from"./Button-DyrnzhHO.js";import{C as d}from"./Card-KCRodOJQ.js";import{I as i}from"./Input-DXbtoITe.js";import{A as C,L as _,T as w}from"./LocationMap-BZ0JD9qd.js";import{A as S}from"./arrow-left-C2-aTYFr.js";import{m as I}from"./motion-6-dhybfo.js";import{C as k,T as q}from"./target-mwEbGTYQ.js";import{D}from"./navigation-vNh8jYs6.js";import{C as T}from"./calendar-BXY3JlmO.js";import"./utils-DGemFq7o.js";import"./search-BLUcUpX8.js";import"./x-CnWmSxWo.js";import"./map-pin-MLfMKbu9.js";import"./index-CVaH9Lp1.js";const Q=()=>{const c=f(),{createTask:h}=N(),{user:u}=j(),[t,s]=n.useState({title:"",description:"",category:"local",priority:"medium",estimated_duration:"",location:"",required_skills:"",budget_credits:"",deadline:"",tags:""}),[a,x]=n.useState(null),[m,g]=n.useState(!1),b=async r=>{if(r.preventDefault(),!!u){g(!0);try{const l={...t,user_id:u.id,status:"open",estimated_duration:parseInt(t.estimated_duration),budget_credits:parseInt(t.budget_credits),required_skills:t.required_skills.split(",").map(o=>o.trim()).filter(Boolean),tags:t.tags.split(",").map(o=>o.trim()).filter(Boolean),deadline:t.deadline||void 0,latitude:a==null?void 0:a.latitude,longitude:a==null?void 0:a.longitude,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};await h(l),c("/")}catch(l){console.error("Erreur lors de la cr√©ation de la t√¢che:",l)}finally{g(!1)}}},y={low:"bg-green-100 text-green-800",medium:"bg-yellow-100 text-yellow-800",high:"bg-orange-100 text-orange-800",urgent:"bg-red-100 text-red-800"},v={low:"üü¢",medium:"üü°",high:"üü†",urgent:"üî¥"};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-primary-50 to-primary-100 pb-20",children:[e.jsx("div",{className:"bg-white shadow-sm border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between p-4",children:[e.jsx(p,{variant:"ghost",size:"sm",onClick:()=>c(-1),className:"p-2",children:e.jsx(S,{className:"w-5 h-5"})}),e.jsx("h1",{className:"text-lg font-semibold text-gray-900",children:"Nouvelle T√¢che"}),e.jsx("div",{className:"w-10"})]})}),e.jsx("div",{className:"p-4 space-y-4",children:e.jsxs(I.form,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},onSubmit:b,className:"space-y-4",children:[e.jsx(d,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:"üìù Informations de base"}),e.jsx(i,{label:"Titre de la t√¢che",value:t.title,onChange:r=>s({...t,title:r.target.value}),placeholder:"Ex: Aide pour d√©m√©nagement",required:!0}),e.jsx(i,{label:"Description",value:t.description,onChange:r=>s({...t,description:r.target.value}),placeholder:"D√©crivez en d√©tail ce dont vous avez besoin...",required:!0,multiline:!0,rows:3}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cat√©gorie"}),e.jsxs("select",{value:t.category,onChange:r=>s({...t,category:r.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[e.jsx("option",{value:"local",children:"üìç Sur place"}),e.jsx("option",{value:"remote",children:"üíª √Ä distance"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Priorit√©"}),e.jsxs("select",{value:t.priority,onChange:r=>s({...t,priority:r.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[e.jsx("option",{value:"low",children:"üü¢ Faible"}),e.jsx("option",{value:"medium",children:"üü° Moyenne"}),e.jsx("option",{value:"high",children:"üü† √âlev√©e"}),e.jsx("option",{value:"urgent",children:"üî¥ Urgente"})]})]})]})]})}),e.jsx(d,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:"üìç D√©tails et localisation"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(i,{label:"Dur√©e estim√©e (heures)",type:"number",value:t.estimated_duration,onChange:r=>s({...t,estimated_duration:r.target.value}),placeholder:"2",required:!0,leftIcon:k}),e.jsx(i,{label:"Budget (cr√©dits)",type:"number",value:t.budget_credits,onChange:r=>s({...t,budget_credits:r.target.value}),placeholder:"50",required:!0,leftIcon:D})]}),e.jsx(C,{label:"Localisation",value:t.location,onChange:r=>s({...t,location:r}),onLocationSelect:(r,l)=>x({latitude:r,longitude:l}),placeholder:"Rechercher une adresse ou utiliser votre localisation actuelle",required:!0}),a&&e.jsx(_,{latitude:a.latitude,longitude:a.longitude,address:t.location,className:"mt-4"}),e.jsx(i,{label:"Comp√©tences requises",value:t.required_skills,onChange:r=>s({...t,required_skills:r.target.value}),placeholder:"Ex: Bricolage, Informatique, Langues (s√©par√©es par des virgules)",leftIcon:q}),e.jsx(i,{label:"Tags",value:t.tags,onChange:r=>s({...t,tags:r.target.value}),placeholder:"Ex: urgent, d√©m√©nagement, aide (s√©par√©s par des virgules)",leftIcon:w}),e.jsx(i,{label:"Date limite (optionnel)",type:"datetime-local",value:t.deadline,onChange:r=>s({...t,deadline:r.target.value}),leftIcon:T})]})}),e.jsx(d,{children:e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:`p-2 rounded-full ${y[t.priority]}`,children:e.jsx("span",{className:"text-lg",children:v[t.priority]})}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-gray-900",children:["Priorit√© ",t.priority.charAt(0).toUpperCase()+t.priority.slice(1)]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[t.priority==="urgent"&&"Besoin imm√©diat",t.priority==="high"&&"Besoin important",t.priority==="medium"&&"Besoin mod√©r√©",t.priority==="low"&&"Pas urgent"]})]})]})}),e.jsx(p,{type:"submit",variant:"primary",size:"lg",loading:m,className:"w-full",disabled:!t.title||!t.description||!t.estimated_duration||!t.budget_credits||t.category==="local"&&!a,children:m?"Cr√©ation...":"Cr√©er la t√¢che"}),t.category==="local"&&!a&&e.jsx("div",{className:"text-center text-sm text-amber-600 bg-amber-50 p-3 rounded-lg border border-amber-200",children:"üìç Pour les t√¢ches sur place, une localisation pr√©cise est requise"})]})})]})};export{Q as default};
